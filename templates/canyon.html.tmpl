<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="view-transition" content="same-origin">
    
    <!-- Page Title -->
    <title>{{.Name}} Live Cameras | Utah Canyon Conditions</title>
    
    <!-- SEO & Social -->
    <meta name="description" content="Live camera feeds for {{if eq .Name "LCC"}}Little Cottonwood Canyon{{else}}Big Cottonwood Canyon{{end}}. Real-time road conditions and weather updates.">
    <meta property="og:title" content="{{.Name}} Live Cameras">
    <meta property="og:description" content="Real-time camera feeds for {{.Name}}">
    <meta property="og:type" content="website">
    
    <!-- Mobile Optimization -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="{{.Name}} Live">
    <meta name="theme-color" content="#667eea">
    
    <!-- Resources -->
    <link rel="stylesheet" href="/s/style.css">
    <link rel="icon" type="image/png" href="/s/favicon.png">
    
    <!-- Prefetch -->
    {{- if eq .Name "LCC" -}}
    <link rel="prefetch" href="/bcc" as="document">
    {{- else -}}
    <link rel="prefetch" href="/" as="document">
    {{- end -}}
    
    <!-- Preconnect for analytics -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
  </head>
  
  <body>
    <!-- Main Header -->
    <header role="banner">
      <!-- Canyon Navigation with Theme Toggle -->
      <nav class="canyon-nav" role="navigation" aria-label="Canyon selection">
        <div class="canyon-toggle">
        {{ if eq .Name "LCC" -}}
        <a href="/" 
           aria-current="page" 
           class="active" 
           role="button"
           aria-label="Little Cottonwood Canyon, currently selected">
          LCC
        </a>
        <a href="/bcc" 
           role="button"
           aria-label="Switch to Big Cottonwood Canyon">
          BCC
        </a>
        {{- else -}}
        <a href="/" 
           role="button"
           aria-label="Switch to Little Cottonwood Canyon">
          LCC
        </a>
        <a href="/bcc" 
           aria-current="page" 
           class="active" 
           role="button"
           aria-label="Big Cottonwood Canyon, currently selected">
          BCC
        </a>
        {{- end -}}
        </div>
        
        <!-- Theme Toggle Button -->
        <button class="theme-toggle" aria-label="Toggle dark mode" title="Toggle theme">
          <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
          <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
          </svg>
        </button>
      </nav>
      
      <!-- Road Status -->
      <road-status role="region" aria-label="Road status" style="display:none">
        <img 
          id="img-{{.Status.ID}}" 
          src="/image/{{.Status.ID}}" 
          alt="{{.Status.Alt}}"
          loading="eager"
          decoding="async">
      </road-status>
    </header>
    
    <!-- Camera Grid -->
    <main role="main">
      <section 
        id="container" 
        role="region" 
        aria-label="{{if eq .Name "LCC"}}Little Cottonwood Canyon{{else}}Big Cottonwood Canyon{{end}} camera feeds">
        {{- range $index, $c := .Cameras -}}
        {{- if ne $c.Kind "roadstatus" -}}
        <camera-feed 
          tabindex="0" 
          role="article"
          aria-label="{{$c.Alt}} camera feed">
          
          {{- if eq $c.Kind "iframe" -}}
          <!-- Embedded iframe camera -->
          <iframe 
            loading="lazy" 
            src="{{$c.Src}}" 
            title="{{$c.Alt}}" 
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            referrerpolicy="strict-origin-when-cross-origin"
            aria-label="{{$c.Alt}}">
          </iframe>
          {{- else -}}
          <!-- Standard image camera -->
          {{- if le $index 1 -}}
          <img 
            src="/image/{{$c.ID}}" 
            alt="{{$c.Alt}}"
            loading="eager"
            decoding="async"
            class="in-viewport">
          {{- else -}}
          <img 
            src="/image/{{$c.ID}}" 
            alt="{{$c.Alt}}" 
            loading="lazy"
            decoding="async">
          {{- end -}}
          {{- end -}}
          
          <h4>{{$c.Alt}}</h4>
        </camera-feed>
        {{- end -}}
        {{- end -}}
      </section>
    </main>
    
    <!-- Lightbox Overlay -->
    <the-overlay 
      role="dialog" 
      aria-modal="true" 
      aria-label="Enlarged camera view">
    </the-overlay>
    
    <!-- Scripts -->
    <script src="/s/script.js" defer></script>
    
    <!-- Analytics (async, non-blocking) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EKMJ5GKF38"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-EKMJ5GKF38', {
        'send_page_view': true,
        'page_title': '{{.Name}} Live Cameras'
      });
    </script>
  </body>
</html>
